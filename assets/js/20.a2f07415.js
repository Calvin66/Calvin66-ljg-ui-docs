(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{422:function(t,e,a){"use strict";a.r(e);var s=a(12),n=Object(s.a)({},(function(){var t=this,e=t._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("p",[t._v("本文为您介绍 Flink SQL 作业开发的"),e("strong",[t._v("操作步骤")]),t._v("。")]),t._v(" "),e("h2",{attrs:{id:"前置条件"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#前置条件"}},[t._v("#")]),t._v(" 前置条件")]),t._v(" "),e("ul",[e("li",[t._v("系统管理员创建 flink 计算引擎，并添加引擎使用者。")]),t._v(" "),e("li",[t._v("系统管理员创建项目，并添加项目成员。")])]),t._v(" "),e("h2",{attrs:{id:"操作步骤"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#操作步骤"}},[t._v("#")]),t._v(" 操作步骤")]),t._v(" "),e("h3",{attrs:{id:"_1-登录赤兔实时计算平台-新建作业"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-登录赤兔实时计算平台-新建作业"}},[t._v("#")]),t._v(" 1.登录赤兔实时计算平台，新建作业")]),t._v(" "),e("p",[e("img",{attrs:{src:"/docs/%E5%BC%80%E5%8F%91SQL%E4%BD%9C%E4%B8%9A-1.png",alt:"开发SQL作业-1"}})]),t._v(" "),e("p",[t._v("​    a.登录赤兔实时计算平台。")]),t._v(" "),e("p",[t._v("​    b.在项目管理，找到目标项目点击"),e("strong",[t._v("进入项目。")])]),t._v(" "),e("p",[t._v("​    c.点击"),e("strong",[t._v("新建。")])]),t._v(" "),e("p",[t._v("​    d.在新建作业对话框，填写作业配置信息。")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"center"}},[t._v("作业")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("说明")]),t._v(" "),e("th",[t._v("是否必填")]),t._v(" "),e("th",[t._v("备注")])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("文件名称")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("作业的名称 同一个项目内作业名唯一。 作业命名规则：字母，数字或下划线。")]),t._v(" "),e("td",[t._v("是")]),t._v(" "),e("td")]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("作业等级")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("作业等级是指作业权重等级，分为P1/P2/P3/P4共4级，作业等级默认和项目等级一致，用户根据实际作业权重设置作业等级。"),e("br"),e("img",{attrs:{src:"/docs/%E9%A1%B9%E7%9B%AE%E7%AE%A1%E7%90%86-1.png",alt:"项目管理-1"}})]),t._v(" "),e("td",[t._v("是")]),t._v(" "),e("td")]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("文件类型")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("文件类型需要选择为SQL/DS，选择SQL")]),t._v(" "),e("td",[t._v("是")]),t._v(" "),e("td")]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("存储位置")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("指定该作业的代码文件所属的文件夹。 您还可以在现有文件夹右侧，单击"),e("img",{attrs:{src:"https://help-static-aliyun-doc.aliyuncs.com/assets/img/zh-CN/7214291261/p277156.png",alt:"新建文件夹"}}),t._v("图标，新建子文件夹。")]),t._v(" "),e("td",[t._v("是")]),t._v(" "),e("td")])])]),t._v(" "),e("p",[t._v("​    e.点击"),e("strong",[t._v("保存。")])]),t._v(" "),e("h3",{attrs:{id:"_2-在作业开发页面右侧-点击元表配置-填写配置信息"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-在作业开发页面右侧-点击元表配置-填写配置信息"}},[t._v("#")]),t._v(" 2.在作业开发页面右侧，点击"),e("strong",[t._v("元表配置")]),t._v("，填写配置信息")]),t._v(" "),e("p",[e("img",{attrs:{src:"https://bg-prd-cos-bdp-1257092428.cos.ap-guangzhou.myqcloud.com/rdp-metadata/portal/2023/2/3/141677825853721.png",alt:"img"}})]),t._v(" "),e("p",[e("strong",[t._v("参数解析如下表所示")])]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"center"}},[t._v("作业参数")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("说明")])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("引用名称")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("元表引用的名称")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("数据源实例")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("文件类型需要选择为kafka/mysql")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("数据库")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("若有数据库，选择数据源实例后自动带出")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("数据库类型")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("若有数据库，选择数据源实例后自动带出")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("Topic")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("数据源实例为kafka时显示，Topic的名称")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("表名")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("数据源实例为mysql时显示，表的名称")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("元表类型")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("元表类型选择为source、sink、dim")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("DDL")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("元表配置信息填写完成后点击生成ddl，会生成ddl语句")])])])]),t._v(" "),e("h3",{attrs:{id:"_3-编写-sql-逻辑"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-编写-sql-逻辑"}},[t._v("#")]),t._v(" 3.编写 sql 逻辑")]),t._v(" "),e("p",[e("img",{attrs:{src:"https://bg-prd-cos-bdp-1257092428.cos.ap-guangzhou.myqcloud.com/rdp-metadata/portal/2023/2/7/171678181335850.png",alt:"img"}})]),t._v(" "),e("p",[t._v("和离线 sql 开发一样，基于创建好的表，做过滤、清洗、转换、去重、join、分组统计、窗口计算等")]),t._v(" "),e("p",[t._v("示例代码如下")]),t._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("-- 使用内置函数解析内容, 根据条件过滤数据, 过滤结果写入视图\nCREATE VIEW db_write_num_view AS\nSELECT\nJSON_VALUE(message,'$.flinkJobId') AS flink_job_id -- flink任务id\n, JSON_VALUE(message,'$.sourceType') AS source_type -- 数据源类型\n, JSON_VALUE(message,'$.databaseTableName') AS database_table_name -- 数据库表名\n, cast(JSON_VALUE(message,'$.type') AS TINYINT) AS type -- 写入成功/失败类型\n, cast(JSON_VALUE(message,'$.num') AS bigint) AS num -- 批次写入数量\nFROM flink_log_demo\nWHERE level = 'INFO'\nAND JSON_EXISTS(message,'$.sdpRunningResultLogFlag')\nAND JSON_VALUE(message,'$.flinkJobId') IS NOT NULL\nAND JSON_VALUE(message,'$.databaseTableName') IS NOT NULL; -- 按照维度(flink任务id、数据源类型、数据库表、写入成功/失败类型) 分组统计\nINSERT INTO ads_db_write_num_result_demo(flink_job_id,source_type,database_table_name,type,num)\nSELECT flink_job_id -- flink任务id\n, source_type -- 数据源类型\n, database_table_name -- 数据库表名\n, type -- 写入成功/失败类型 , sum(num) -- 批次写入数量\nFROM db_write_num_view\nGROUP BY flink_job_id, type, source_type, database_table_name;\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br"),e("span",{staticClass:"line-number"},[t._v("6")]),e("br"),e("span",{staticClass:"line-number"},[t._v("7")]),e("br"),e("span",{staticClass:"line-number"},[t._v("8")]),e("br"),e("span",{staticClass:"line-number"},[t._v("9")]),e("br"),e("span",{staticClass:"line-number"},[t._v("10")]),e("br"),e("span",{staticClass:"line-number"},[t._v("11")]),e("br"),e("span",{staticClass:"line-number"},[t._v("12")]),e("br"),e("span",{staticClass:"line-number"},[t._v("13")]),e("br"),e("span",{staticClass:"line-number"},[t._v("14")]),e("br"),e("span",{staticClass:"line-number"},[t._v("15")]),e("br"),e("span",{staticClass:"line-number"},[t._v("16")]),e("br"),e("span",{staticClass:"line-number"},[t._v("17")]),e("br"),e("span",{staticClass:"line-number"},[t._v("18")]),e("br"),e("span",{staticClass:"line-number"},[t._v("19")]),e("br"),e("span",{staticClass:"line-number"},[t._v("20")]),e("br")])]),e("p",[e("strong",[t._v("按钮说明如下表所示")])]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"center"}},[t._v("按钮名称")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("说明")])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("保存")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("作业本地保存")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("撤销")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("编辑器内容上一步操作内容的回退")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("恢复")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("编辑器内容上一步操作内容的恢复")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("查找")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("按照输入内容进行模糊匹配。查找功能包括：模糊匹配，精确匹配，结果统计，向上查找结果，向下查找结果，结果高亮显示")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("格式化")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("编辑器内容按照标准编码规范进行美化代码")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("转生产")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("UAT代码同步至生产环境")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("验证")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("通过调用flink接口验证脚本编辑器内容是否符合flink 语义和语法的规范")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"center"}},[t._v("发布至UAT")]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[t._v("作业发布到配置的集群")])])])])])}),[],!1,null,null,null);e.default=n.exports}}]);